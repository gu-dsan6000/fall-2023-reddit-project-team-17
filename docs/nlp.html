<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>It's Storytime! – nlp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">It’s Storytime!</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Main</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./secondary/code-and-data.html" rel="" target="">
 <span class="menu-text">Code and Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./secondary/authors.html" rel="" target="">
 <span class="menu-text">Authors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./secondary/references.html" rel="" target="">
 <span class="menu-text">References</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nlp.html">NLP</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda/topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda/exploratory-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nlp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">NLP</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive summary</a></li>
  <li><a href="#flair-sentiment-model" id="toc-flair-sentiment-model" class="nav-link" data-scroll-target="#flair-sentiment-model">Flair Sentiment Model</a></li>
  <li><a href="#preparing-reddit-data-for-multi-class-classification" id="toc-preparing-reddit-data-for-multi-class-classification" class="nav-link" data-scroll-target="#preparing-reddit-data-for-multi-class-classification">Preparing Reddit data for multi-class classification</a></li>
  <li><a href="#preparing-covid-19-data-in-nostupidquestions" id="toc-preparing-covid-19-data-in-nostupidquestions" class="nav-link" data-scroll-target="#preparing-covid-19-data-in-nostupidquestions">Preparing Covid-19 data in <code>NoStupidQuestions</code></a></li>
  <li><a href="#preparing-reddit-and-external-data-for-training-an-rnn" id="toc-preparing-reddit-and-external-data-for-training-an-rnn" class="nav-link" data-scroll-target="#preparing-reddit-and-external-data-for-training-an-rnn">Preparing Reddit and External Data for Training an RNN</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">NLP</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive summary</h2>
</section>
<section id="flair-sentiment-model" class="level2">
<h2 class="anchored" data-anchor-id="flair-sentiment-model">Flair Sentiment Model</h2>
<p>In this section we explored the textual content of the posts of r/AmItheAsshole (r/AITA) with respect to their assigned flairs and subsequently applying a pretrained sentiment model. Using a sparkNLP pipeline, all text posts from r/AITA in 2022 with one of the four primary flairs (Asshole, Not the A-hole, Everybody Sucks, No A-holes Here) attached were processed/cleaned and run through a pretrained sentiment model. The sentiment model most commonly assigned these posts a “negative” sentiment, as shown in <a href="#fig-flair-sentiments-barchart">Figure&nbsp;1</a>. This holds true across posts assigned any of the four primary flairs.</p>
<div id="fig-flair-sentiments-barchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/flair_sentiments_barchart.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Shows the subreddit sentiment by flair.</figcaption>
</figure>
</div>
<p>To further delve into the sentiments of these posts in r/AITA, we analyzed these sentiment assignments with respect to the engagement a post receives, represented by the number of comments under each posts. In the <a href="#fig-flair-engagements-barchart">Figure&nbsp;2</a>, the mean number of comments per post grouped by flair assignment and sentiment assignment.</p>
<div id="fig-flair-engagements-barchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/flair_engagements_barchart.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Shows the subreddit engagement by flair.</figcaption>
</figure>
</div>
<p>From this plot above, we can extract several conclusions. We can see that posts assigned the “Asshole” flair receive the most user engagement (on average) and posts assigned “No A-holes here” receive the least engagement, on average. Additionally, it is apparent that posts assigned a “negative” sentiment receive less user engagement than those with a “positive” sentiment across all four primary flairs. Thus, it is possible there could be a relationship wherein the more “positive” a post’s sentiment/writing is, the more likely it is to receive more engagement (at least in the form of number of comments).</p>
<div class="cell tbl-cap-location-bottom" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<div id="tbl-aita-sentiment-engagements" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;1: Displays the r/AITA subreddit sentiment engagements.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Flair</th>
<th style="text-align: right;">Negative</th>
<th style="text-align: right;">Neutral</th>
<th style="text-align: right;">Positive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Asshole</td>
<td style="text-align: right;">242.2</td>
<td style="text-align: right;">225.59</td>
<td style="text-align: right;">265.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">Everyone Sucks</td>
<td style="text-align: right;">104.88</td>
<td style="text-align: right;">172.31</td>
<td style="text-align: right;">183.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No A-holes here</td>
<td style="text-align: right;">63.15</td>
<td style="text-align: right;">67.74</td>
<td style="text-align: right;">90.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">Not the A-hole</td>
<td style="text-align: right;">105.07</td>
<td style="text-align: right;">128.07</td>
<td style="text-align: right;">148.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="preparing-reddit-data-for-multi-class-classification" class="level2">
<h2 class="anchored" data-anchor-id="preparing-reddit-data-for-multi-class-classification">Preparing Reddit data for multi-class classification</h2>
<p>See in <a href="#fig-sentiment-age">Figure&nbsp;3</a>.</p>
<div id="fig-sentiment-age" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/predicting-subreddits-density-age.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Shows how age is distributed across sentiment</figcaption>
</figure>
</div>
<p>See in <a href="#fig-sentiment-gender">Figure&nbsp;4</a>.</p>
<div id="fig-sentiment-gender" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/predicting-subreddits-density-gender.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Shows how gender is distributed across sentiment</figcaption>
</figure>
</div>
<p>See in <a href="#tbl-gender-table">Table&nbsp;2</a>.</p>
<div class="cell tbl-cap-location-bottom" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<div id="tbl-gender-table" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;2: Displays the distribution of sentiment across genders.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Female</th>
<th style="text-align: right;">Male</th>
<th style="text-align: right;">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="preparing-covid-19-data-in-nostupidquestions" class="level2">
<h2 class="anchored" data-anchor-id="preparing-covid-19-data-in-nostupidquestions">Preparing Covid-19 data in <code>NoStupidQuestions</code></h2>
<p>See in <a href="#fig-covid-nsq">Figure&nbsp;5</a>.</p>
<div id="fig-covid-nsq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/covid-nsq.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Shows how gender is distributed across sentiment</figcaption>
</figure>
</div>
</section>
<section id="preparing-reddit-and-external-data-for-training-an-rnn" class="level2">
<h2 class="anchored" data-anchor-id="preparing-reddit-and-external-data-for-training-an-rnn">Preparing Reddit and External Data for Training an RNN</h2>
<p>For this exercise, we focused on preparing text that contains great storytelling to train a Recurrent Neural Network (RNN) that can generate new stories. We use our 12 months of Reddit submissions data described in the EDA section for the analysis. Additionally, we integrate external data containing the text of famous stories from Project Gutenberg books that have stood the test of time, specifically <em>The Scarlet Letter</em> by Nathaniel Hawthorne, <em>The Odyssey</em> by Homer, <em>Crime and Punishment</em> by Fyodor Dostoyevsky, <em>Metamorphosis</em> by Franz Kafka, and <em>The Great Gatsby</em> by F. Scott Fitzgerald.</p>
<p>To prepare the Reddit data, we extracted only the relevant information from the parquets, such as <code>subreddit</code>, <code>title</code>, <code>selftext</code>, <code>score</code>, and <code>URL</code>, and filtered out deleted or empty submissions. To select the best stories, we used a regular expressions pattern to remove any “Edit:” sections to remove post-edit additions that could skew the analysis. Since stories must be at least a few paragraphs, we removed all posts that didn’t have at least 4500 characters (around 750 words). Then, we filtered for only stored with <code>score</code> in the top 85th percentile, thereby focusing on submissions that garnered significant user interaction.</p>
<p>We then combined the text sources. The data underwent a series of NLP transformations, including custom tokenization and lowercasing, to prepare it for advanced analysis. We constructed a vocabulary and transformed the individual characters into tokens. The resulting frequency of each token is shown in <a href="#fig-token-frequency-plot">Figure&nbsp;6</a>. Lastly, we stored the processed data in a structured Parquet format alongside the character-to-index mappings, crucial for the subsequent machine-learning modeling.</p>
<div id="fig-token-frequency-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/nlp-plots/books-and-stories-token-frequency-plot.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Shows the count of the Top 10 tokens</figcaption>
</figure>
</div>
<p>As an additionally way to visualize the resulting dataset, we also can see the results of the top 10 N-Grams, where <span class="math inline">\(N=5\)</span> in <a href="#tbl-n-gram-results">Table&nbsp;3</a>.</p>
<div class="cell tbl-cap-location-bottom" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="4">
<div id="tbl-n-gram-results" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;3: displays the top 10 most frequent N-Grams where <span class="math inline">\(N=5\)</span>.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">5-Gram (incl spaces)</th>
<th style="text-align: left;">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i was</td>
<td style="text-align: left;">22,165</td>
</tr>
<tr class="even">
<td style="text-align: left;">and i</td>
<td style="text-align: left;">17,933</td>
</tr>
<tr class="odd">
<td style="text-align: left;">in the</td>
<td style="text-align: left;">15,264</td>
</tr>
<tr class="even">
<td style="text-align: left;">of the</td>
<td style="text-align: left;">13,807</td>
</tr>
<tr class="odd">
<td style="text-align: left;">that i</td>
<td style="text-align: left;">11,631</td>
</tr>
<tr class="even">
<td style="text-align: left;">to be</td>
<td style="text-align: left;">10,346</td>
</tr>
<tr class="odd">
<td style="text-align: left;">it was</td>
<td style="text-align: left;">10,172</td>
</tr>
<tr class="even">
<td style="text-align: left;">to the</td>
<td style="text-align: left;">9,418</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i had</td>
<td style="text-align: left;">8,307</td>
</tr>
<tr class="even">
<td style="text-align: left;">i dont</td>
<td style="text-align: left;">8,212</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">A project by Team 17.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Made with and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/gu-dsan6000/fall-2023-reddit-project-team-17">View the source at GitHub</a></div>
  </div>
</footer>



</body></html>